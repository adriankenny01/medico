{% extends 'base.html.twig' %}

{% block title %}Dashboard!{% endblock %}

{% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('css/fullcalendar.min.css') }}" />
{% endblock %}

{% block body %}

 {# <div class="container">
        <div class="row">
            <div class="col-sm">
                <div class="card text-white bg-primary mb-3" style="max-width: 20rem;">
                    <div class="card-header">Medicos</div>
                        <div class="card-body">
                            <h4 class="card-title">Primary card title</h4>
                    </div>
                </div>
            </div>
            <div class="col-sm">
                <div class="card text-white bg-primary mb-3" style="max-width: 20rem;">
                    <div class="card-header">Empleados</div>
                        <div class="card-body">
                            <h4 class="card-title">Primary card title</h4>
                    </div>
                </div>
            </div>
            <div class="col-sm">
                <div class="card text-white bg-primary mb-3" style="max-width: 20rem;">
                    <div class="card-header">Pacientes</div>
                        <div class="card-body">
                            <h4 class="card-title">Primary card title</h4>
                    </div>
                </div>
            </div>
            <div class="col-sm">
                <div class="card text-white bg-primary mb-3" style="max-width: 20rem;">
                    <div class="card-header">Citas de hoy</div>
                        <div class="card-body">
                            <h4 class="card-title">Primary card title</h4>
                    </div>
                </div>
            </div>
        </div>
    </div> #}

    <h2 class="mt-2">Calendario de citas</h2>
    <div id="calendar" class="mb-5"></div>

{% endblock %}

{% block javascripts %}
    <script src="/js/main.js"></script>
    <script src="/js/moment.min.js"></script>
    <script src="/js/fullcalendar.min.js"></script>
    <script src="/js/locale-all.js"> </script>

    <script>
         $(document).ready(function() {

            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth() + 1; //January is 0!
            var yyyy = today.getFullYear();

            if (dd < 10) {
            dd = '0' + dd;
            }

            if (mm < 10) {
            mm = '0' + mm;
            }

            today = yyyy + '-' + mm + '-' + dd ;
            
            $('#calendar').fullCalendar({

                header: {
                    left: 'prev,next today',
                    center: 'title',
                    right: 'month,agendaWeek,agendaDay,listWeek'
                },
                locale: 'es',
                themeSystem: 'bootstrap4',
                defaultDate: today,
                editable: true,
                eventLimit: true, // allow "more" link when too many events,

                eventClick: function(calEvent, jsEvent, view) {
                    
                    if (calEvent.url) {
                        url = calEvent.url + "" + calEvent.id;
                        window.open(url);
                        return false;
                    }

                    alert('Event: ' + calEvent.url);
                    // change the border color just for fun
                    $(this).css('border-color', 'red');

                },

                eventRender: function(event, element) { 
                    element.find('.fc-title').append(
                        "<br/>" + "Paciente: "+event.patient_name + 
                        "<br/>" + "Doctor: "+event.medic_name
                        ); 
                }, 

                events: {
                    url: "/appointment/fetch/",
                    cache: false
                } 
                /*
                events: [
                    {
                    title: 'All Day Event',
                    start: '2019-01-01'
                    },
                    {
                    title: 'Long Event',
                    start: '2019-01-07',
                    end: '2019-01-10'
                    },
                    {
                    id: 999,
                    title: 'Repeating Event',
                    start: '2019-01-09T16:00:00'
                    },
                    {
                    id: 999,
                    title: 'Repeating Event',
                    start: '2019-01-16T16:00:00'
                    },
                    {
                    title: 'Conference',
                    start: '2019-01-11',
                    end: '2019-01-13'
                    },
                    {
                    title: 'Meeting',
                    start: '2019-01-12T10:30:00',
                    end: '2019-01-12T12:30:00'
                    },
                    {
                    title: 'Lunch',
                    start: '2019-01-12T12:00:00'
                    },
                    {
                    title: 'Meeting',
                    start: '2019-01-12T14:30:00'
                    },
                    {
                    title: 'Happy Hour',
                    start: '2019-01-12T17:30:00'
                    },
                    {
                    title: 'Dinner',
                    start: '2019-01-12T20:00:00'
                    },
                    {
                    title: 'Birthday Party',
                    start: '2019-01-13T07:00:00'
                    },
                    {
                    title: 'Click for Google',
                    url: 'http://google.com/',
                    start: '2019-01-28'
                    }
                ]*/
                });

        });

    </script>
{% endblock %}